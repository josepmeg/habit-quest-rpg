<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HabitQuest RPG</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="p-4 md:p-8">

    <div id="notification" class="notification fixed top-5 right-5 bg-green-500 text-white p-4 rounded-lg shadow-lg opacity-0 transform translate-y-10 z-50"></div>

    <div id="main-content" class="max-w-7xl mx-auto space-y-8">
        <header class="card rounded-lg p-6">
            <div class="text-center mb-6">
                <h1 class="font-rpg text-2xl md:text-4xl text-title-beige text-center my-4">HabitQuest</h1>
            </div>
        
            <div class="flex flex-col md:flex-row items-start justify-center gap-4 md:gap-6">
        
                <div id="player-column" class="flex-1 w-full text-center space-y-3">
                    <h2 id="player-name-header" class="font-rpg text-xl md:text-2xl text-center text-white mb-2">
                        <span id="player-name" class="cursor-pointer hover:text-gray-300">Player</span>
                    </h2>
                    <div class="relative inline-block">
                        <img src="assets/sprites/player.png" class="pixel-art w-[35vw] h-auto max-w-32 md:max-w-40">
                    </div>
        
                    <div class="space-y-2 px-2">
                        <div><span class="text-sm font-bold text-hp-green">HP</span><div class="progress-bar-bg rounded-full"><div id="player-hp-bar" class="progress-bar-fill h-6 rounded-full hp-gradient"></div></div><span id="player-hp-text" class="text-xs"></span></div>
                        <div><span class="text-sm font-bold text-blue-400">MP</span><div class="progress-bar-bg rounded-full"><div id="player-mp-bar" class="progress-bar-fill h-4 rounded-full mp-gradient"></div></div><span id="player-mp-text" class="text-xs"></span></div>
                        <div><span id="player-exp-label" class="text-sm font-bold text-purple-400">Lvl</span><div class="progress-bar-bg rounded-full"><div id="player-exp-bar" class="progress-bar-fill h-4 rounded-full exp-gradient"></div></div><span id="player-exp-text" class="text-xs"></span> </div>
                    </div>
                    <div class="action-bar flex justify-center items-center gap-4 pt-2">
                        <button id="inventory-modal-btn" title="Inventory" class="btn action-btn-sand rounded-full p-4">
                            <img src="assets/icons/inventory.png" class="w-6 h-6">
                        </button>
                        <button id="skills-modal-btn" title="Skills" class="btn action-btn-sand rounded-full p-4">
                            <img src="assets/icons/skills.png" class="w-6 h-6"> 
                        </button>
                        <button id="player-stats-modal-btn" title="History" class="btn action-btn-sand rounded-full p-4">
                            <img src="assets/icons/stats.png" class="w-6 h-6"> 
                        </button>
                        <button id="shop-modal-btn" title="Shop" class="btn action-btn-sand rounded-full p-4">
                            <img src="assets/icons/shop.png" class="w-6 h-6">
                        </button>
                    </div>
                </div>
        
                <div class="hidden md:flex items-center justify-center">
                    <span class="font-rpg text-4xl lg:text-6xl text-red-500">VS</span>
                </div>
        
                <div id="boss-column" class="flex-1 w-full flex flex-col text-center space-y-3 relative">
                    <h2 id="boss-name" class="font-rpg text-xl md:text-2xl text-red-500"></h2>
                    <div class="relative inline-block">
                        <img id="boss-image" src="assets/sprites/ifrit.png" class="pixel-art w-[35vw] h-auto max-w-32 md:max-w-40 mx-auto">
                    </div>
                
                    <div class="space-y-2 px-2">
                        <div><span class="text-sm font-bold text-red-400">HP</span><div class="progress-bar-bg rounded-full"><div id="boss-hp-bar" class="progress-bar-fill h-6 rounded-full bg-red-600"></div></div><span id="boss-hp-text" class="text-xs"></span></div>
                    </div>
                
                    <div class="action-bar flex justify-center items-center gap-4 pt-2 mt-auto">
                        <button id="collection-modal-btn" title="Grimoire" class="btn action-btn-sand rounded-full p-4">
                            <img src="assets/icons/grimoire.png" class="w-6 h-6">
                        </button>
                         <button id="boss-modal-btn" title="Manage Bosses" class="btn action-btn-sand rounded-full p-4">
                            <svg class="w-6 h-6" xmlns="http://www.w.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path d="M2 4a1 1 0 011-1h14a1 1 0 110 2H3a1 1 0 01-1-1zm0 6a1 1 0 011-1h14a1 1 0 110 2H3a1 1 0 01-1-1zm0 6a1 1 0 011-1h14a1 1 0 110 2H3a1 1 0 01-1-1z"></path></svg>
                        </button>
                        <button id="info-modal-btn" title="Info" class="btn action-btn-sand rounded-full p-4">
                            <img src="assets/icons/info.png" class="w-6 h-6">                        
                        </button>
                    </div>
                </div>
        
            </div>
        </header>

        <!-- OLD Attack Buttons
        <section class="text-center space-y-4 my-6">
            <div class="flex justify-center items-center gap-4">
                <button id="attack-btn" title="Attack" class="attack-btn btn font-rpg bg-indigo-600 text-white p-4 rounded-lg shadow-lg hover:bg-indigo-700 disabled:bg-gray-500 disabled:cursor-not-allowed disabled:shadow-none">
                    <span class="text-3xl">‚öîÔ∏è</span>
                </button>
                <button id="special-attack-btn" title="Fireball" class="special-attack-btn btn font-rpg bg-indigo-600 text-white p-4 rounded-lg shadow-lg hover:bg-indigo-700 disabled:bg-gray-500 disabled:cursor-not-allowed disabled:shadow-none">
                    <span class="text-3xl">üî•</span>
                </button>
            </div>
            <div>
                <p id="attack-message" class="text-sm text-gray-400 mt-2 h-4 attack-message-text"></p>
                <p id="special-attack-message" class="text-sm text-gray-400 mt-2 h-4 attack-message-text"></p>
            </div>
        </section>
        -->
        <section id="combat-actions-container" class="my-6">
            <div id="skill-carousel" class="flex justify-center items-center gap-3 p-2 overflow-x-auto">
                </div>
        </section>
        
        <main class="space-y-6">
            <section class="card rounded-lg p-4">
                <div class="w-full flex justify-between items-center">
                    <button id="workout-toggle" class="flex-grow text-left">
                        <h3 class="font-rpg text-lg text-yellow-400 flex items-center gap-3">
                            <div class="icon-background">
                                <img src="assets/icons/workout.png" class="w-7 h-7">
                            </div>
                            <span>Work Out Log <span id="workout-counter" class="text-sm"></span></span>
                            <span id="workout-arrow" class="ml-auto mr-4">‚ñº</span>
                        </h3>
                    </button>
                    <div class="flex gap-2 pr-2">
                        <button id="add-workout-btn" class="btn action-btn-sand rounded-md p-2 font-bold text-lg">+</button>
                        <button id="edit-workout-btn" class="btn action-btn-sand rounded-md p-2">
                            <img src="assets/icons/edit.png" class="w-5 h-5">
                        </button>
                    </div>
                </div>
                <div id="workout-content" class="collapsible-content mt-4 space-y-3"></div>
            </section>
            
            <section class="card rounded-lg p-4">
                <div class="w-full flex justify-between items-center">
                    <button id="habits-toggle" class="flex-grow text-left">
                        <h3 class="font-rpg text-lg text-yellow-400 flex items-center gap-3">
                            <div class="icon-background">
                                <img src="assets/icons/habits.png" class="w-7 h-7">
                            </div>
                            <span>Daily Habits <span id="habits-counter" class="text-sm"></span></span>
                            <span id="habits-arrow" class="ml-auto mr-4">‚ñº</span>
                        </h3>
                    </button>
                    <div class="flex gap-2 pr-2">
                        <button id="add-habit-btn" class="btn action-btn-sand rounded-md p-2 font-bold text-lg">+</button>
                        <button id="edit-habit-btn" class="btn action-btn-sand rounded-md p-2">
                            <img src="assets/icons/edit.png" class="w-5 h-5">
                        </button>
                    </div>
                </div>
                <div id="daily-habits-content" class="collapsible-content mt-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
            </section>
            
            <section class="card rounded-lg p-4">
                <button id="quests-toggle" class="w-full text-left">
                    <h3 class="font-rpg text-lg text-purple-400 flex items-center gap-3">
                        <div class="icon-background">
                            <img src="assets/icons/quests.png" class="w-6 h-6">
                        </div>
                        <span>Quest Board <span id="quest-counter" class="text-sm"></span></span>
                        <span id="quests-arrow" class="ml-auto">‚ñº</span>
                    </h3>
                </button>
                <div id="quests-content" class="collapsible-content mt-4 space-y-3"></div>
            </section>
            
            <section class="card rounded-lg p-4">
                <button id="attributes-toggle" class="w-full text-left">
                    <h3 class="font-rpg text-lg text-yellow-400 flex items-center gap-3">
                        <div class="icon-background">
                            <img src="assets/icons/attributes.png" class="w-7 h-7">
                        </div>
                        <span>Player Attributes</span>
                        <span id="attributes-arrow" class="ml-auto">‚ñº</span>
                    </h3>
                </button>
                <div id="attributes-content" class="collapsible-content mt-4"></div>
            </section>            
        </main>
        
        <footer class="text-center text-gray-500 text-xs mt-8">
            <p id="footer-text">Game data is saved locally in your browser.</p>
        </footer>
    </div>

     <div id="boss-modal" class="modal fixed inset-0 z-40 flex items-center justify-center hidden">
        <div class="modal-overlay fixed inset-0"></div>
        <div class="modal-content card rounded-lg p-6 w-full max-w-md m-4 relative">
            <h3 class="font-rpg text-xl text-yellow-400 mb-4">Boss Management</h3>
            <button id="boss-modal-close" class="absolute top-4 right-4 text-gray-400 hover:text-white">&times;</button>
            <div class="space-y-4">
                <div>
                    <h4 class="font-semibold mb-2">Add New Boss</h4>
                    <form id="add-boss-form" class="grid grid-cols-3 gap-2">
                        <select id="new-boss-name" class="task-input col-span-2 rounded-md p-2" required></select>
                        <input id="new-boss-hp" type="number" placeholder="HP" class="task-input rounded-md p-2" required>
                        <button type="submit" class="col-span-3 btn bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md">Add to Queue</button>
                    </form>
                </div>
                <div>
                    <h4 class="font-semibold mb-2">Upcoming Bosses</h4>
                    <ul id="boss-queue-list" class="space-y-2 max-h-40 overflow-y-auto"></ul>
                </div>
                <!--<div>
                    <h4 class="font-semibold mb-2">Defeated Bosses</h4>
                    <ul id="defeated-boss-list" class="space-y-2 max-h-40 overflow-y-auto"></ul>
                </div>-->
            </div>
        </div>
    </div>

    <div id="info-modal" class="modal fixed inset-0 z-40 flex items-center justify-center hidden">
        <div class="modal-overlay fixed inset-0"></div>
        <div class="modal-content card rounded-lg p-6 w-full max-w-md relative">
            <h3 class="font-rpg text-xl text-blue-400 mb-4">How To Play</h3>
            <button id="info-modal-close" class="absolute top-4 right-4 text-gray-400 hover:text-white">&times;</button>
            <div class="space-y-2 text-gray-300">
                <div class="card p-2 rounded-md">
                    <button id="info-core-toggle" class="w-full text-left flex justify-between items-center">
                        <h4 class="font-semibold text-green-400">The Core Loop</h4>
                        <span id="info-core-arrow" class="font-rpg">‚ñº</span>
                    </button>
                    <div id="info-core-content" class="collapsible-content pt-2 mt-2 border-t border-gray-600">
                        <p>Complete real-life <span class="font-bold">Workouts</span> and <span class="font-bold">Habits</span> to earn the right to attack the boss once per day. Winning battles earns you EXP and Gold to become more powerful.</p>
                    </div>
                </div>
                <div class="card p-2 rounded-md">
                    <button id="info-combat-toggle" class="w-full text-left flex justify-between items-center">
                        <h4 class="font-semibold text-yellow-400">Combat & Stats</h4>
                        <span id="info-combat-arrow" class="font-rpg">‚ñº</span>
                    </button>
                    <div id="info-combat-content" class="collapsible-content pt-2 mt-2 border-t border-gray-600 space-y-2">
                        <p><span class="font-bold text-red-400">Attack:</span> Your total damage is based on your Attack stat (from levels and equipment) plus a streak bonus.</p>
                        <p><span class="font-bold text-yellow-400">Luck:</span> Your Luck stat gives you a chance to land a CRITICAL HIT for double damage!</p>
                        <p><span class="font-bold text-indigo-400">Fireball:</span> This special attack costs MP but deals significantly more damage.</p>
                    </div>
                </div>
                <div class="card p-2 rounded-md">
                    <button id="info-progression-toggle" class="w-full text-left flex justify-between items-center">
                        <h4 class="font-semibold text-purple-400">Progression & Rewards</h4>
                        <span id="info-progression-arrow" class="font-rpg">‚ñº</span>
                    </button>
                    <div id="info-progression-content" class="collapsible-content pt-2 mt-2 border-t border-gray-600 space-y-2">
                        <p><span class="font-bold">Leveling Up:</span> Gaining EXP by completing tasks and fighting will increase your Level, permanently boosting your stats and healing you fully.</p>
                        <p><span class="font-bold text-yellow-400">Gold:</span> Completing workouts and habits earns you Gold, which you can spend in the Shop on useful items.</p>
                    </div>
                </div>
                <div class="card p-2 rounded-md">
                    <button id="info-equipment-toggle" class="w-full text-left flex justify-between items-center">
                        <h4 class="font-semibold text-blue-400">The Armory (Equipment)</h4>
                        <span id="info-equipment-arrow" class="font-rpg">‚ñº</span>
                    </button>
                    <div id="info-equipment-content" class="collapsible-content pt-2 mt-2 border-t border-gray-600">
                        <p>Buy or find <span class="font-bold">Equipment</span> like swords and armor. Equipping them from your inventory provides permanent stat bonuses.</p>
                    </div>
                </div>
                <div class="border-t border-gray-600 pt-4 mt-4 space-y-2">
                    <h4 class="font-semibold text-gray-400 text-sm text-center">Manage Data</h4>
                    <div class="flex gap-2">
                        <button id="export-btn" class="btn w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md">Export Save</button>
                        <label class="btn w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md text-center cursor-pointer">
                            Import Save
                            <input type="file" id="import-input" class="hidden" accept=".json,application/json">
                        </label>
                    </div>
                    <button id="reset-game-btn" class="btn w-full bg-red-800 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md">RESET GAME PROGRESS</button>
                </div>
            </div>
        </div>
    </div>

    <div id="player-stats-modal" class="modal fixed inset-0 z-40 flex items-center justify-center hidden">
        <div class="modal-overlay fixed inset-0"></div>
        <div class="modal-content card rounded-lg p-6 w-full max-w-2xl m-4 relative">
            <h3 class="font-rpg text-xl text-blue-400 mb-4">Player Stats & History</h3>
            <button id="player-stats-modal-close" class="absolute top-4 right-4 text-gray-400 hover:text-white">&times;</button>
            <div id="history-content" class="text-gray-300 max-h-[70vh] overflow-y-auto">
                <div class="flex justify-between items-center mb-4">
                    <button id="prev-month-btn" class="btn action-btn-sand p-2 rounded-md"><span>&#9664;</span></button>
                    <h4 id="calendar-title" class="font-rpg text-lg text-center"></h4>
                    <button id="next-month-btn" class="btn action-btn-sand p-2 rounded-md"><span>&#9654;</span></button>
                </div>
                <div id="calendar-grid-container">
                </div>
            </div>
        </div>
    </div>

    <div id="inventory-modal" class="modal fixed inset-0 z-40 flex items-center justify-center hidden">
        <div class="modal-overlay fixed inset-0"></div>
        <div class="modal-content card rounded-lg p-6 w-full max-w-2xl m-4 relative">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-rpg text-xl text-blue-400">Inventory</h3>
                <button id="inventory-modal-close" class="absolute top-4 right-4 text-gray-400 hover:text-white">&times;</button>
            </div>
            <div class="space-y-4">
                <div>
                    <h4 class="font-rpg text-sm text-gray-400 mb-2">--- CHARACTER & EQUIPMENT ---</h4>
                    <div class="flex flex-col md:flex-row gap-4">
                        <div class="card p-4 rounded-md flex-shrink-0 text-center space-y-2">
                            <img src="assets/sprites/player.png" class="pixel-art w-24 h-24 mx-auto">
                            <p id="inventory-player-name" class="font-bold"></p>
                        </div>
                        <div class="flex-grow grid grid-cols-1 gap-2">
                            <div id="equipped-weapon-slot" class="card p-2 rounded-md"></div>
                            <div id="equipped-armor-slot" class="card p-2 rounded-md"></div>
                        </div>
                    </div>
                </div>
                <div>
                    <h4 class="font-rpg text-sm text-gray-400 mb-2">--- BACKPACK ---</h4>
                    <div id="inventory-content" class="modal-interior-background p-2 rounded-md space-y-2 text-gray-300 min-h-[150px] max-h-[30vh] overflow-y-auto">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="skills-modal" class="modal fixed inset-0 z-40 flex items-center justify-center hidden">
        <div class="modal-overlay fixed inset-0"></div>
        <div class="modal-content card rounded-lg p-6 w-full max-w-6xl m-4 relative h-[90vh] flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-rpg text-xl text-yellow-400">Skill Tree</h3>
            
                <div class="flex items-center gap-6">
                    <div class="text-base font-rpg text-white">
                        Skill Points: <span id="skill-points-display" class="text-green-400">0</span>
                    </div>
                    <button id="skills-modal-close" class="text-2xl text-gray-400 hover:text-white">&times;</button>
                </div>
            </div>
    
        <div id="skill-tree-viewport" class="flex-grow rounded-md overflow-hidden relative" style="background-image: url('assets/ui/skill-tree-background.png'); background-size: cover; background-position: center;">
            
                <div id="skill-tree-canvas" class="absolute top-0 left-0">
                    </div>
            </div>
    
            <div id="skill-info-panel" class="mt-4 p-4 modal-interior-background rounded-md h-32 hidden">
                </div>
        </div>
    </div>
    
    <div id="summary-modal" class="modal fixed inset-0 z-40 flex items-center justify-center hidden">
        <div class="modal-overlay fixed inset-0"></div>
        <div class="modal-content card rounded-lg p-6 w-full max-w-md m-4 relative">
            <h3 id="summary-modal-title" class="font-rpg text-xl text-green-400 mb-4">Daily Summary</h3>
            <button id="summary-modal-close" class="absolute top-4 right-4 text-gray-400 hover:text-white">&times;</button>
            <div id="summary-modal-content" class="space-y-4 text-gray-300 max-h-[60vh] overflow-y-auto"></div>
        </div>
    </div>

    <div id="shop-modal" class="modal fixed inset-0 z-40 flex items-center justify-center hidden">
        <div class="modal-overlay fixed inset-0"></div>
        <div class="modal-content card rounded-lg p-6 w-full max-w-4xl m-4 relative">
            <h3 class="font-rpg text-xl text-yellow-400 mb-4">Shop</h3>
            <button id="shop-modal-close" class="absolute top-4 right-4 text-gray-400 hover:text-white">&times;</button>
            <div class="flex items-center gap-4 mb-4 p-2 card rounded-md">
                <img src="assets/sprites/shopkeeper.png" class="pixel-art w-20 h-20 flex-shrink-0">
                <div class="flex-grow card p-3 rounded-lg relative border border-gray-600">
                    <p class="text-sm text-gray-300">"Welcome, adventurer! See anything you like?"</p>
                </div>
                <div class="flex items-center gap-2 text-yellow-400 font-bold flex-shrink-0">
                    <span class="hidden md:inline">Your Gold:</span>
                    <img src="assets/icons/gold.png" class="w-5 h-5">
                    <span id="shop-gold-display">0</span>
                </div>
            </div>
            <div id="shop-items-container" class="modal-interior-background p-2 rounded-md space-y-3 max-h-[50vh] overflow-y-auto">
            </div>
        </div>
    </div>
    <div id="field-chooser-modal" class="modal fixed inset-0 z-50 flex items-center justify-center hidden">
        <div class="modal-overlay fixed inset-0"></div>
        <div class="modal-content card rounded-lg p-6 w-full max-w-sm m-4 relative">
            <h3 class="font-rpg text-lg text-yellow-400 mb-4">Choose Workout Fields</h3>
            <div id="field-checkboxes" class="grid grid-cols-2 gap-4 mb-6">
                <label class="flex items-center space-x-2"><input type="checkbox" value="Weight" class="task-checkbox"> <span>Weight</span></label>
                <label class="flex items-center space-x-2"><input type="checkbox" value="Reps" class="task-checkbox"> <span>Reps</span></label>
                <label class="flex items-center space-x-2"><input type="checkbox" value="Rounds" class="task-checkbox"> <span>Rounds</span></label>
                <label class="flex items-center space-x-2"><input type="checkbox" value="Time" class="task-checkbox"> <span>Time</span></label>
                <label class="flex items-center space-x-2"><input type="checkbox" value="Distance" class="task-checkbox"> <span>Distance</span></label>
            </div>
            <div class="flex gap-4">
                <button id="create-workout-btn" class="btn flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md">Create</button>
                <button id="cancel-field-chooser-btn" class="btn flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-md">Cancel</button>
            </div>
        </div>
    </div>
    <div id="collection-modal" class="modal fixed inset-0 z-40 flex items-center justify-center hidden">
        <div class="modal-overlay fixed inset-0"></div>
        <div class="modal-content card rounded-lg p-6 w-full max-w-4xl m-4 relative">
            <h3 class="font-rpg text-xl text-yellow-400 mb-4">Grimoire of Monsters</h3>
            <button id="collection-modal-close" class="absolute top-4 right-4 text-gray-400 hover:text-white">&times;</button>
            <div id="collection-grid" class="modal-interior-background p-4 rounded-md grid gap-4 grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 max-h-[70vh] overflow-y-auto">
                </div>
        </div>
    </div>
    <script type="module" src="js/script.js"></script>
    <audio id="sfx-attack-hit" src="assets/sfx/attack-hit.mp3" preload="auto"></audio>
    <audio id="sfx-fireball" src="assets/sfx/fireball.mp3" preload="auto"></audio>
    <audio id="sfx-task-complete" src="assets/sfx/task-complete.mp3" preload="auto"></audio>
    <audio id="sfx-level-up" src="assets/sfx/level-up.mp3" preload="auto"></audio>
</body>
</html>













































































